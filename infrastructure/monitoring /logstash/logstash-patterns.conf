# ====================== ThiQaX Custom Logstash Patterns ======================
# This file contains custom grok patterns for parsing ThiQaX-specific log formats

# ThiQaX API Request Patterns
THIQAX_REQUEST_ID [0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}
THIQAX_USER_ID [0-9a-f]{24}
THIQAX_API_PATH /api/v[0-9]+/[a-zA-Z0-9_-]+(?:/[a-zA-Z0-9_-]+)*

# ThiQaX API Log Pattern
# Format: [TIMESTAMP] [LEVEL] [MODULE] [requestId=UUID] [userId=ID] message
THIQAX_API_LOG \[%{TIMESTAMP_ISO8601:timestamp}\] \[%{LOGLEVEL:log.level}\] \[%{DATA:log.logger}\](?: \[requestId=%{THIQAX_REQUEST_ID:transaction.id}\])?(?: \[userId=%{THIQAX_USER_ID:user.id}\])? %{GREEDYDATA:log.message}

# ThiQaX API Request Log Pattern
# Format: [TIMESTAMP] [INFO] [HttpLogger] [requestId=UUID] [userId=ID] method=METHOD path=PATH statusCode=CODE responseTime=TIME ms
THIQAX_API_REQUEST \[%{TIMESTAMP_ISO8601:timestamp}\] \[%{LOGLEVEL:log.level}\] \[HttpLogger\] \[requestId=%{THIQAX_REQUEST_ID:transaction.id}\](?: \[userId=%{THIQAX_USER_ID:user.id}\])? method=%{WORD:http.request.method} path=%{THIQAX_API_PATH:url.path}(?: query=%{DATA:url.query})? statusCode=%{NUMBER:http.response.status_code:int} responseTime=%{NUMBER:event.duration:float} ms

# ThiQaX API Error Log Pattern
# Format: [TIMESTAMP] [ERROR] [MODULE] [requestId=UUID] [userId=ID] Error: message\nstack trace
THIQAX_API_ERROR \[%{TIMESTAMP_ISO8601:timestamp}\] \[ERROR\] \[%{DATA:log.logger}\](?: \[requestId=%{THIQAX_REQUEST_ID:transaction.id}\])?(?: \[userId=%{THIQAX_USER_ID:user.id}\])? (?:Error: )?%{GREEDYDATA:error.message}

# ThiQaX Frontend Log Pattern
# Similar to API but with client information
THIQAX_FRONTEND_LOG \[%{TIMESTAMP_ISO8601:timestamp}\] \[%{LOGLEVEL:log.level}\] \[%{DATA:log.logger}\](?: \[sessionId=%{DATA:session.id}\])?(?: \[clientIp=%{IP:client.ip}\])? %{GREEDYDATA:log.message}

# ThiQaX KYC Verification Log Pattern
# Format: [TIMESTAMP] [LEVEL] [KYC] [requestId=UUID] [userId=ID] [documentId=ID] status=STATUS message
THIQAX_KYC_LOG \[%{TIMESTAMP_ISO8601:timestamp}\] \[%{LOGLEVEL:log.level}\] \[KYC\](?: \[requestId=%{THIQAX_REQUEST_ID:transaction.id}\])?(?: \[userId=%{THIQAX_USER_ID:user.id}\])?(?: \[documentId=%{DATA:document.id}\])? status=%{WORD:kyc.status} %{GREEDYDATA:log.message}

# ThiQaX Payment Log Pattern
# Format: [TIMESTAMP] [LEVEL] [Payment] [requestId=UUID] [userId=ID] [transactionId=ID] status=STATUS amount=AMOUNT currency=CURRENCY
THIQAX_PAYMENT_LOG \[%{TIMESTAMP_ISO8601:timestamp}\] \[%{LOGLEVEL:log.level}\] \[Payment\](?: \[requestId=%{THIQAX_REQUEST_ID:transaction.id}\])?(?: \[userId=%{THIQAX_USER_ID:user.id}\])?(?: \[transactionId=%{DATA:payment.id}\])? status=%{WORD:payment.status} amount=%{NUMBER:payment.amount:float} currency=%{WORD:payment.currency}(?: provider=%{WORD:payment.provider})?(?: %{GREEDYDATA:log.message})?

# ThiQaX Job Application Log Pattern
# Format: [TIMESTAMP] [LEVEL] [JobApplication] [requestId=UUID] [userId=ID] [applicationId=ID] status=STATUS jobId=ID
THIQAX_APPLICATION_LOG \[%{TIMESTAMP_ISO8601:timestamp}\] \[%{LOGLEVEL:log.level}\] \[JobApplication\](?: \[requestId=%{THIQAX_REQUEST_ID:transaction.id}\])?(?: \[userId=%{THIQAX_USER_ID:user.id}\])?(?: \[applicationId=%{DATA:application.id}\])? status=%{WORD:application.status} jobId=%{DATA:job.id}(?: %{GREEDYDATA:log.message})?

# ThiQaX Notification Log Pattern
# Format: [TIMESTAMP] [LEVEL] [Notification] [requestId=UUID] [userId=ID] [notificationId=ID] type=TYPE channel=CHANNEL status=STATUS
THIQAX_NOTIFICATION_LOG \[%{TIMESTAMP_ISO8601:timestamp}\] \[%{LOGLEVEL:log.level}\] \[Notification\](?: \[requestId=%{THIQAX_REQUEST_ID:transaction.id}\])?(?: \[userId=%{THIQAX_USER_ID:user.id}\])?(?: \[notificationId=%{DATA:notification.id}\])? type=%{WORD:notification.type} channel=%{WORD:notification.channel} status=%{WORD:notification.status}(?: %{GREEDYDATA:log.message})?

# ThiQaX Blockchain Integration Log Pattern
# Format: [TIMESTAMP] [LEVEL] [Blockchain] [requestId=UUID] [userId=ID] [transactionHash=HASH] operation=OPERATION status=STATUS
THIQAX_BLOCKCHAIN_LOG \[%{TIMESTAMP_ISO8601:timestamp}\] \[%{LOGLEVEL:log.level}\] \[Blockchain\](?: \[requestId=%{THIQAX_REQUEST_ID:transaction.id}\])?(?: \[userId=%{THIQAX_USER_ID:user.id}\])?(?: \[transactionHash=%{DATA:blockchain.hash}\])? operation=%{WORD:blockchain.operation} status=%{WORD:blockchain.status}(?: %{GREEDYDATA:log.message})?

# ThiQaX AI Integration Log Pattern
# Format: [TIMESTAMP] [LEVEL] [AI] [requestId=UUID] [userId=ID] operation=OPERATION documentId=ID result=RESULT confidence=SCORE
THIQAX_AI_LOG \[%{TIMESTAMP_ISO8601:timestamp}\] \[%{LOGLEVEL:log.level}\] \[AI\](?: \[requestId=%{THIQAX_REQUEST_ID:transaction.id}\])?(?: \[userId=%{THIQAX_USER_ID:user.id}\])? operation=%{WORD:ai.operation}(?: documentId=%{DATA:document.id})? result=%{WORD:ai.result} confidence=%{NUMBER:ai.confidence:float}(?: %{GREEDYDATA:log.message})?

# ThiQaX Security Log Pattern
# Format: [TIMESTAMP] [LEVEL] [Security] [requestId=UUID] [userId=ID] [IP=CLIENT_IP] event=EVENT status=STATUS
THIQAX_SECURITY_LOG \[%{TIMESTAMP_ISO8601:timestamp}\] \[%{LOGLEVEL:log.level}\] \[Security\](?: \[requestId=%{THIQAX_REQUEST_ID:transaction.id}\])?(?: \[userId=%{THIQAX_USER_ID:user.id}\])?(?: \[IP=%{IP:client.ip}\])? event=%{WORD:security.event} status=%{WORD:security.status}(?: %{GREEDYDATA:log.message})?

# ThiQaX Performance Log Pattern
# Format: [TIMESTAMP] [LEVEL] [Performance] [requestId=UUID] operation=OPERATION duration=TIME_MS resource=RESOURCE
THIQAX_PERFORMANCE_LOG \[%{TIMESTAMP_ISO8601:timestamp}\] \[%{LOGLEVEL:log.level}\] \[Performance\](?: \[requestId=%{THIQAX_REQUEST_ID:transaction.id}\])? operation=%{WORD:performance.operation} duration=%{NUMBER:event.duration:float}ms resource=%{WORD:performance.resource}(?: %{GREEDYDATA:log.message})?

# Custom status code patterns
HTTP_STATUS_SUCCESS 2\d{2}
HTTP_STATUS_REDIRECT 3\d{2}
HTTP_STATUS_CLIENT_ERROR 4\d{2}
HTTP_STATUS_SERVER_ERROR 5\d{2}

# ThiQaX document status patterns
KYC_STATUS (PENDING|APPROVED|REJECTED|EXPIRED)
PAYMENT_STATUS (PENDING|COMPLETED|FAILED|REFUNDED)
APPLICATION_STATUS (DRAFT|SUBMITTED|UNDER_REVIEW|APPROVED|REJECTED)
NOTIFICATION_STATUS (PENDING|SENT|DELIVERED|READ|FAILED)
SECURITY_EVENT (LOGIN|LOGOUT|PASSWORD_CHANGE|PASSWORD_RESET|ACCOUNT_LOCKED|KYC_ATTEMPT)
SECURITY_STATUS (SUCCESS|FAILURE|BLOCKED|SUSPICIOUS)
